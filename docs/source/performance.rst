===========
Performance
===========

Performance tests for `tomopy cli <https://tomopycli.readthedocs.io/en/latest/>`_ and `tomocupy cli <https://tomocupycli.readthedocs.io/en/latest/>`_ using the streaming data analysis cluster tomo 1-2 located at beamline 2-BM of the Advancd Photon source:

.. _cluster: https://anl.box.com/s/uysvb5ujnlugmd16r2f6o10fem9rjgvr
.. _disk_array: https://anl.box.com/s/zzyvv7w80ltwbtf09zrjiqiw7ak6i7ge
.. _cluster_quote: https://anl.box.com/s/j7wz6li4afoq2gs5g8feehmmz8q7whuy
.. _disk_array_quote: https://anl.box.com/s/sbft8cbt2xcpzuuvikixr82dn9jf6zog


+---------------+------------------------------------+-----------------------+-------------------+
| Computer name |                  CPU               |         GPU           |       RAM         | 
+---------------+------------------------------------+-----------------------+-------------------+
| tomo 1-2      | 2x Intel Xeon Gold 6326 2.90GHz    | 1x NVidia Tesla A100  |      1 TB       | 
+---------------+------------------------------------+-----------------------+-------------------+


+-----------+--------------+---------------+-----------------+---------------------------------+----------------------+
| Station   | Name         | Product       | Part list       |      Model                      |      Quote           |
+-----------+--------------+---------------+-----------------+---------------------------------+----------------------+
| 2-BM      | tomo 1-2     | MNJ15421064   | `cluster`_      |  Supermicro 740GP-TNRT cluster  | `cluster_quote`_     |
+-----------+--------------+---------------+-----------------+---------------------------------+----------------------+
| 2-BM      | disk array   | MNJ15508749   | `disk_array`_   |  SYS-220U-TNR Storage           | `disk_array_quote`_  |
+-----------+--------------+---------------+-----------------+---------------------------------+----------------------+

 

**Data: 1500x2048x2448,  ring removal on**

+---------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|    Method     |      Time      |  Command                                                                                                                                                                                                   |
+---------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| tomopy        |     4m3.914s   |  tomopy recon --file-name /data/2021-10/Cooley/285_1_SPFP_072.h5 --reconstruction-type full  --rotation-axis 1108 --rotation-axis-auto manual --gridrec-padding True --remove-stripe-method fw             |
+---------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| tomocupy 1GPU |     1m0.590s   |  tomocupy recon --file-name /data/2021-10/Cooley/285_1_SPFP_072.h5 --rotation-axis 1108 --reconstruction-type full --remove-stripe-method fw                                                               |
+---------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| tomocupy 2GPU |     0m41.264s  |  tomocupy reconmulti --file-name /data/2021-10/Cooley/285_1_SPFP_072.h5 --rotation-axis 1108 --reconstruction-type full --remove-stripe-method fw                                                          |
+---------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

**Data: 1500x2048x2448,  ring removal off**

+---------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|    Method     |      Time      |  Command                                                                                                                                                                                                   |
+---------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| tomopy        |     2m1.059s   |  tomopy recon --file-name /data/2021-10/Cooley/285_1_SPFP_072.h5 --reconstruction-type full  --rotation-axis 1108 --rotation-axis-auto manual --gridrec-padding True                                       |
+---------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| tomocupy 1GPU |     0m33.753s  |  tomocupy recon --file-name /data/2021-10/Cooley/285_1_SPFP_072.h5 --rotation-axis 1108 --reconstruction-type full                                                                                         |
+---------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| tomocupy 2GPU |     0m25.653s  |  tomocupy reconmulti --file-name /data/2021-10/Cooley/285_1_SPFP_072.h5 --rotation-axis 1108 --reconstruction-type full                                                                                    |
+---------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


**Data: 3000x2048x2448, double fov, ring removal on**

+---------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|    Method     |      Time      |  Command                                                                                                                                                                                                                     |
+---------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| tomopy        |   10m48.947s   |  tomopy recon --file-name /data/2021-10/Cooley/Dogfish_1B_redo_106.h5 --reconstruction-type full  --rotation-axis 100 - --file-type double_fov --rotation-axis-auto manual --gridrec-padding True --remove-stripe-method fw  |
+---------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| tomocupy 1GPU |     2m33.330s  |  tomocupy recon --file-name /data/2021-10/Cooley/Dogfish_1B_redo_106.h5 --reconstruction-type full  --rotation-axis 100 - --file-type double_fov --remove-stripe-method fw                                                   |
+---------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| tomocupy 2GPU |     1m30.010s  |  tomocupy reconmulti --file-name /data/2021-10/Cooley/Dogfish_1B_redo_106.h5 --reconstruction-type full  --rotation-axis 100 - --file-type double_fov --remove-stripe-method fw                                              |
+---------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

**Data: 3000x2048x2448, double fov, ring removal off**

+---------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|    Method     |      Time      |  Command                                                                                                                                                                                                                     |
+---------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| tomopy        |   7m58.321s    |  tomopy recon --file-name /data/2021-10/Cooley/Dogfish_1B_redo_106.h5 --reconstruction-type full  --rotation-axis 100 - --file-type double_fov --rotation-axis-auto manual --gridrec-padding True                            |
+---------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| tomocupy 1GPU |     1m56.257s  |  tomocupy recon --file-name /data/2021-10/Cooley/Dogfish_1B_redo_106.h5 --reconstruction-type full  --rotation-axis 100 - --file-type double_fov                                                                             |
+---------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| tomocupy 2GPU |     1m12.932s  |  tomocupy reconmulti --file-name /data/2021-10/Cooley/Dogfish_1B_redo_106.h5 --reconstruction-type full  --rotation-axis 100 - --file-type double_fov                                                                        |
+---------------+----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

